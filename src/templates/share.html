<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–î–µ–ª–∏ - –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ–∫–æ–º</title>
    <style>
        /* Sber-inspired Palette */
        :root {
            --primary-green: #08a552; /* Main green */
            --accent-green-yellow: #9fe61f; /* Bright green/yellow */
            --accent-teal: #42e3b4; /* Lighter teal/green */
            --text-dark: #1a1a1a; /* Darker than pure black for text */
            --text-light: #ffffff;
            --card-background: #ffffff; /* White background for the card */
            --border-gradient: linear-gradient(135deg, var(--primary-green), var(--accent-green-yellow)); /* Gradient for the border */
            --button-hover-opacity: 0.85;
            --shadow-color: rgba(8, 165, 82, 0.15); /* Shadow based on primary green */
            --border-thickness: 3px; /* Control border thickness */
            --widget-border-radius: 18px; /* Consistent rounding */
            --paste-button-bg: #2db26c; /* New color for paste button */
        }

        body {
            font-family: 'Arial', sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 25px 20px;
            color: var(--text-dark);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: var(--text-dark); /* Changed to black */
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }
        .header div:not(.logo) { /* Subtitle style */
            font-size: 16px;
            color: var(--text-dark); /* Changed to black */
            opacity: 0.9;
        }

        /* Outer container for border and shadow */
        .widget-bordered {
            /* No background here! */
            border-radius: var(--widget-border-radius); /* Rounding for the border and shadow */
            box-shadow: 0 5px 20px var(--shadow-color); /* Shadow on the outer element */
            margin-bottom: 40px;
            position: relative; /* Needed for ::before */
            z-index: 1; /* Context for ::before */
            overflow: hidden; /* Clip the ::before element */
            /* Add padding equal to border thickness to push content away from the edge */
             padding: var(--border-thickness);
        }

        /* Gradient Border using ::before */
        .widget-bordered::before {
            content: '';
            position: absolute;
            top: 0; /* Align with the outer container */
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border-gradient); /* Gradient background */
            z-index: -1; /* Behind the inner .widget-content */
            border-radius: inherit; /* Match parent's rounding */
        }

        /* Inner container for white background and content padding */
        .widget-content {
            background-color: var(--card-background); /* White background here */
             /* Slightly smaller radius for perfect fit inside the border */
             border-radius: calc(var(--widget-border-radius) - var(--border-thickness));
             padding: 25px; /* Actual content padding */
             /* Ensure content height calculation works well */
             height: 100%;
             box-sizing: border-box;
        }


        /* Specific styles for receipt card */
        .receipt-card {
             /* Inherits .widget-bordered styles */
        }

        /* Adjust padding for the inner content */
         .receipt-card .widget-content {
             padding: 25px;
         }

        .receipt-title {
            font-size: 22px;
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary-green);
            font-weight: 600;
        }

        .amount-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            /* Removed margin as padding is on .widget-content */
            flex-wrap: wrap;
            margin-top: 30px; /* Add margin back if needed */
            margin-bottom: 30px;
        }

        #receiptAmountInput {
            font-size: 42px;
            font-weight: bold;
            color: var(--primary-green);
            border: 2px solid var(--primary-green);
            border-radius: 10px;
            padding: 8px 12px;
            width: auto;
            min-width: 120px;
            max-width: 220px;
            text-align: right;
            background-color: #fdfdfd;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            -webkit-appearance: none;
            margin: 0;
            -moz-appearance: textfield;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        #receiptAmountInput:focus {
            outline: none;
            border-color: var(--accent-green-yellow);
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05), 0 0 5px var(--accent-green-yellow);
        }

        .currency-symbol {
            font-size: 42px;
            font-weight: bold;
            color: var(--primary-green);
            padding-left: 5px;
        }

        #pasteAmountButton {
            padding: 10px 15px;
            font-size: 15px;
            font-weight: 600;
            background-color: var(--paste-button-bg); /* Changed background color */
            color: var(--text-light); /* Changed text color to black */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s, opacity 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #pasteAmountButton:hover {
            opacity: 0.9; /* Adjusted hover effect slightly */
            transform: translateY(-1px);
        }
        #pasteAmountButton:active {
             transform: translateY(0px);
             box-shadow: 0 1px 2px rgba(0,0,0,0.1);
             opacity: 0.95;
        }

        /* Specific styles for share section */
        .share-section {
            /* Inherits .widget-bordered styles */
            margin-top: 20px;
        }

        /* Adjust padding for the inner content */
         .share-section .widget-content {
             padding: 20px; /* Slightly less padding */
         }


        .share-title {
            margin-bottom: 20px;
            font-size: 20px;
            color: var(--primary-green);
            font-weight: 600;
            text-align: center;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .share-button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            color: var(--text-light);
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: opacity 0.3s, transform 0.2s, box-shadow 0.3s;
            background-color: var(--primary-green);
            box-shadow: 0 3px 8px var(--shadow-color);
            min-width: 150px;
        }

        .share-button:hover {
            opacity: var(--button-hover-opacity);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px var(--shadow-color);
        }
         .share-button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 5px var(--shadow-color);
        }

        .icon {
            width: 22px;
            height: 22px;
        }

    </style>
    <!-- Flask background style (kept as requested) -->
    <style> body { background-image: url("/static/images/splash.png"); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed; } </style>
</head>
<body>
    <div class="header">
        <div class="logo">–ü–æ–î–µ–ª–∏!</div>
        <div>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—É–º–º–æ–π –∏–∑ —á–µ–∫–∞ –ª–µ–≥–∫–æ</div>
    </div>

    <!-- Receipt Card with Gradient Border -->
    <div class="receipt-card widget-bordered">
        <div class="widget-content">
            <div class="receipt-title">–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—É–º–º—É —á–µ–∫–∞</div>
            <div class="amount-container">
                 <input type="number" id="receiptAmountInput" step="0.01" min="0" value="0" placeholder="0.00">
                 <span class="currency-symbol">‚ÇΩ</span>
                 <button id="pasteAmountButton" title="–í—Å—Ç–∞–≤–∏—Ç—å —Å—É–º–º—É –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞">üìã –í—Å—Ç–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Share Section with Gradient Border -->
    <div class="share-section widget-bordered">
        <div class="widget-content">
            <div class="share-title">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π</div>
            <div class="share-buttons">
                <!-- VK Button -->
                <button class="share-button" id="shareVk">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white">
                        <path d="M15.07 2H8.93C3.33 2 2 3.33 2 8.93V15.07C2 20.67 3.33 22 8.93 22H15.07C20.67 22 22 20.67 22 15.07V8.93C22 3.33 20.67 2 15.07 2M18.15 16.27H16.69C16.14 16.27 15.97 15.82 15 14.83C14.12 13.94 13.74 13.71 13.53 13.71C13.24 13.71 13.15 13.83 13.15 14.38V15.69C13.15 16.04 13.04 16.26 12.11 16.26C10.57 16.26 8.86 15.32 7.66 13.59C5.85 11.05 5.36 9.13 5.36 8.75C5.36 8.54 5.43 8.34 5.85 8.34H7.32C7.69 8.34 7.83 8.5 7.97 8.9C8.69 11 9.89 12.8 10.38 12.8C10.57 12.8 10.65 12.71 10.65 12.25V10.1C10.6 9.12 10.07 9.03 10.07 8.68C10.07 8.5 10.21 8.34 10.44 8.34H12.73C13.04 8.34 13.15 8.5 13.15 8.88V11.77C13.15 12.08 13.28 12.19 13.38 12.19C13.56 12.19 13.72 12.08 14.05 11.74C15.1 10.57 15.85 8.76 15.85 8.76C15.95 8.55 16.11 8.35 16.5 8.35H17.93C18.37 8.35 18.47 8.58 18.37 8.89C18.19 9.74 16.41 12.25 16.43 12.25C16.27 12.5 16.21 12.61 16.43 12.9C16.58 13.11 17.09 13.55 17.43 13.94C18.05 14.65 18.53 15.24 18.66 15.65C18.77 16.06 18.57 16.27 18.15 16.27Z"/>
                </svg>
                –í–ö–æ–Ω—Ç–∞–∫—Ç–µ
            </button>

            <!-- Telegram Button -->
            <button class="share-button" id="shareTelegram">
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white">
                    <path d="M9.78,18.65L10.06,14.42L17.74,7.5C18.08,7.19 17.67,7.04 17.22,7.31L7.74,13.3L3.64,12C2.76,11.75 2.75,11.14 3.84,10.7L19.81,4.54C20.54,4.21 21.24,4.72 20.96,5.84L18.24,18.65C18.05,19.56 17.5,19.78 16.74,19.36L12.6,16.3L10.61,18.23C10.38,18.46 10.19,18.65 9.78,18.65Z"/>
                </svg>
                Telegram
            </button>
        </div>
        </div>
    </div>

    <script>
        // JS code –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        const amountInput = document.getElementById('receiptAmountInput');
        const pasteButton = document.getElementById('pasteAmountButton');
        const shareVkButton = document.getElementById('shareVk');
        const shareTelegramButton = document.getElementById('shareTelegram');
        let currentAmount = 0;
        const pageBaseUrl = window.location.origin + window.location.pathname;
        function parseAmount(text) {
            if (!text) return null;
            const cleanedText = text.replace(/[^0-9.,]/g, '').replace(',', '.');
            const value = parseFloat(cleanedText);
            return isNaN(value) || value < 0 ? null : value.toFixed(2);
        }
        function updateAmount(newAmount) {
            currentAmount = parseFloat(newAmount) || 0;
            const formattedAmountForDisplay = currentAmount.toLocaleString('ru-RU', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            const formattedAmountForInput = currentAmount.toFixed(2);
            if (amountInput.value !== formattedAmountForInput) {
                 amountInput.value = formattedAmountForInput;
            }
            const shareUrlWithParam = `${pageBaseUrl}?amount=${currentAmount.toFixed(2)}`;
            const shareTextBase = `–Ø —Ä–∞–∑–¥–µ–ª–∏–ª(–∞) —á–µ–∫ –Ω–∞ ${formattedAmountForDisplay} ‚ÇΩ —Å –ø–æ–º–æ—â—å—é –ü–æ–î–µ–ª–∏!`;
            const shareCommentVk = `–û—Ç–ª–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —á–µ–∫–æ–≤: ${shareUrlWithParam}`;
            const shareUrlVk = `https://vk.com/share.php?url=${encodeURIComponent(shareUrlWithParam)}&title=${encodeURIComponent(shareTextBase)}&comment=${encodeURIComponent(shareCommentVk.substring(0, 800))}`;
            const shareUrlTelegram = `https://t.me/share/url?url=${encodeURIComponent(shareUrlWithParam)}&text=${encodeURIComponent(shareTextBase + ' –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è: ' + shareUrlWithParam)}`;
            shareVkButton.onclick = () => window.open(shareUrlVk, '_blank', 'width=600,height=450,noopener,noreferrer');
            shareTelegramButton.onclick = () => window.open(shareUrlTelegram, '_blank', 'width=600,height=450,noopener,noreferrer');
        }
        const urlParams = new URLSearchParams(window.location.search);
        const initialAmountParam = urlParams.get('amount');
        const initialAmount = parseAmount(initialAmountParam) || 0;
        updateAmount(initialAmount);
        amountInput.addEventListener('input', (event) => {
            const value = event.target.value;
            if (/^\d*\.?\d{0,2}$/.test(value) || value === '') {
                updateAmount(value || 0);
            }
        });
         amountInput.addEventListener('change', (event) => {
            const value = event.target.value;
            const parsed = parseAmount(value);
            updateAmount(parsed !== null ? parsed : 0);
         });
        pasteButton.addEventListener('click', async () => {
            try {
                if (!navigator.clipboard || !navigator.clipboard.readText) {
                     alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å—Ç–∞–≤–∫—É –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞.');
                     return;
                }
                const text = await navigator.clipboard.readText();
                const parsed = parseAmount(text);
                if (parsed !== null) {
                    updateAmount(parsed);
                }
            } catch (err) {
                console.error('–û—à–∏–±–∫–∞ –≤—Å—Ç–∞–≤–∫–∏ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞:', err);
                if (err.name === 'NotAllowedError') {
                     alert('–î–æ—Å—Ç—É–ø –∫ –±—É—Ñ–µ—Ä—É –æ–±–º–µ–Ω–∞ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞ –∏–ª–∏ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞.');
                } else {
                     alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.');
                }
            }
        });
        updateAmount(currentAmount);
    </script>
</body>
</html>